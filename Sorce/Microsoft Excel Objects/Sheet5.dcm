VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet5"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True



Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  On Error GoTo catchError


  Exit Sub
'エラー発生時=====================================================================================
catchError:
  Call Library.endScript
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim selectCells As String
  Dim line As Long, activeCellLine As Long

  On Error GoTo catchError
  
  Call init.setting
  selectCells = Selection.Address(False, False)


  If Cells(Target.row, Target.Column).Style = "Error" Then
    Cells(Target.row, Target.Column).Style = "Normal"
  
  ElseIf selectCells Like "*:*" Then
    Exit Sub
  
  
  '担当者を複数選択するとき
  ElseIf Target.Column = Library.getColumnNo(setVal("cell_Assign")) And Target.Value = "複数選択" Then
    Call Library.startScript
    Call WBS_Option.担当者の複数選択
    Call Library.endScript
  
  '担当者を複数選択でないとき
  ElseIf Target.Column = Library.getColumnNo(setVal("cell_Assign")) Then
    Call Library.startScript
    
    activeCellLine = ActiveCell.row
    line = activeCellLine + 1
      
    Do While Range(setVal("cell_Info") & line) = setVal("TaskInfoStr_Multi")
      line = line + 1
    Loop
    If line > activeCellLine + 1 Then
      Rows(activeCellLine + 1 & ":" & line - 1).Delete Shift:=xlUp
    End If
    Range(setVal("cell_TaskAllocation") & Target.row) = ""
    Range(setVal("cell_Info") & Target.row) = ""
    
    Call Library.endScript
  ElseIf Intersect(Target, Columns("C:R")) Is Nothing Then
    Exit Sub
  Else
    If Range("A" & Target.row) = "" And Cells(Target.row, Target.Column) <> "" Then
      Call Library.startScript
      
      Call Calendar.行書式コピー(Target.row, Target.row)
      'Range(setVal("cell_PlanStart") & Target.row).Select
      Cells(Target.row, Target.Column).Select
      
      Call Library.endScript
      Exit Sub
    End If
  End If
    
  
  Exit Sub

'エラー発生時=====================================================================================
catchError:
  Call Library.showNotice(Err.Number, Err.Description, True)
End Sub



Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  Dim line As Long
  
  Call init.setting
  If changeShapesName <> "" Then
    Call Library.startScript
    Call Chart.changeShapes
    Call Library.endScript(True)
  ElseIf Cells(Target.row, Target.Column) = "＋" Then
    Call Library.startScript
    line = Target.row + 1
    Do While Range(setVal("cell_Info") & line) Like "*" & setVal("TaskInfoStr_Multi") & "*"
      line = line + 1
    Loop
    
    Cells(Target.row, Target.Column) = "−"
    Rows(Target.row + 1 & ":" & line - 1).EntireRow.Hidden = False
    Range(setVal("cell_TaskArea") & Target.row + 1).Select
    Call Library.endScript
  ElseIf Cells(Target.row, Target.Column) = "−" Then
    Call Library.startScript
    line = Target.row + 1
    Do While Range(setVal("cell_Info") & line) Like "*" & setVal("TaskInfoStr_Multi") & "*"
      line = line + 1
    Loop
    
    Cells(Target.row, Target.Column) = "＋"
    Rows(Target.row + 1 & ":" & line - 1).EntireRow.Hidden = True
    Range(setVal("cell_TaskArea") & Target.row + 1).Select
    Call Library.endScript
  End If
  
  Exit Sub

'エラー発生時=====================================================================================
catchError:
  Call Library.showNotice(Err.Number, Err.Description, True)
End Sub



'**************************************************************************************************
' * 右クリックメニュー
' *
' * @author Bunpei.Koizumi<bunpei.koizumi@gmail.com>
'**************************************************************************************************
Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  
  Call WBS_Option.右クリックメニュー(Target, Cancel)
  
End Sub

