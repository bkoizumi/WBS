VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "clsUF_Cal5Label1R"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
'***************************************************************************************************
'   カレンダーフォーム5用日付ラベル                                 clsUF_Cal5Label1R(Class)
'
'   作成者:井上治  URL:http://www.ne.jp/asahi/excel/inoue/ [Excelでお仕事!]
'***************************************************************************************************
'変更日付 Rev  変更履歴内容------------------------------------------------------------------------>
'18/11/28(1.80)新規作成
'***************************************************************************************************
Option Explicit
'===================================================================================================
Public WithEvents Label As MSForms.Label                        ' 日付ラベル
Attribute Label.VB_VarHelpID = -1
Private g_lngIndex As Long                                      ' 位置INDEX(0〜44)
Private g_dteHiduke As Date                                     ' 日付
Private g_lngYobi As Long                                       ' 曜日
Private g_lngSyuku As Long                                      ' 祝日フラグ
Private g_strGuide As String                                    ' ステータスガイド

'***************************************************************************************************
'   ■■■ 初期化 ■■■
'***************************************************************************************************
'* 処理名　：NewClass
'* 機能　　：クラス初期化
'---------------------------------------------------------------------------------------------------
'* 返り値　：(なし)
'* 引数　　：Arg1 = ラベル(Object)
'* 　　　　　Arg2 = 位置INDEX(Long)
'---------------------------------------------------------------------------------------------------
'* 作成日　：2018年11月28日
'* 作成者　：井上　治
'* 更新日　：2018年11月28日
'* 更新者　：井上　治
'* 機能説明：
'* 注意事項：
'***************************************************************************************************
Public Sub NewClass(ByVal objLabel As MSForms.Label, ByVal lngIx As Long)
    '-----------------------------------------------------------------------------------------------
    Set Label = objLabel
    g_lngIndex = lngIx
End Sub

'***************************************************************************************************
'* 処理名　：Label_Click
'* 機能　　：ラベルのクリックイベント
'---------------------------------------------------------------------------------------------------
'* 返り値　：(なし)
'* 引数　　：(なし)
'---------------------------------------------------------------------------------------------------
'* 作成日　：2018年11月28日
'* 作成者　：井上　治
'* 更新日　：2018年11月28日
'* 更新者　：井上　治
'* 機能説明：
'* 注意事項：
'***************************************************************************************************
Private Sub Label_Click()
    '-----------------------------------------------------------------------------------------------
    Call UF_Calendar5R.GP_ClickCalendar(g_lngIndex)
End Sub

'***************************************************************************************************
'* 処理名　：Label_MouseMove
'* 機能　　：ラベルのMouseMoveイベント
'---------------------------------------------------------------------------------------------------
'* 返り値　：(なし)
'* 引数　　：(なし)
'---------------------------------------------------------------------------------------------------
'* 作成日　：2018年11月28日
'* 作成者　：井上　治
'* 更新日　：2018年11月28日
'* 更新者　：井上　治
'* 機能説明：
'* 注意事項：
'***************************************************************************************************
Private Sub Label_MouseMove(ByVal Button As Integer, _
                            ByVal Shift As Integer, _
                            ByVal x As Single, _
                            ByVal y As Single)
    '-----------------------------------------------------------------------------------------------
    Call UF_Calendar5R.GP_ShowGuide(g_lngIndex)
End Sub

'***************************************************************************************************
'   ■■■ プロパティ ■■■
'***************************************************************************************************
' 日付(Date)
'---------------------------------------------------------------------------------------------------
Public Property Let Hiduke(ByVal dteDate As Date)
    g_dteHiduke = dteDate
End Property
Public Property Get Hiduke() As Date
    Hiduke = g_dteHiduke
End Property

'===================================================================================================
' 曜日(Long)
'---------------------------------------------------------------------------------------------------
Public Property Let Yobi(ByVal lngYobi As Long)
    g_lngYobi = lngYobi
End Property
Public Property Get Yobi() As Long
    Yobi = g_lngYobi
End Property

'===================================================================================================
' 祝日フラグ(Long)
'---------------------------------------------------------------------------------------------------
Public Property Let Syuku(ByVal lngSyuku As Long)
    g_lngSyuku = lngSyuku
End Property
Public Property Get Syuku() As Long
    Syuku = g_lngSyuku
End Property

'===================================================================================================
' ステータスガイド(String)
'---------------------------------------------------------------------------------------------------
Public Property Let StsGuide(ByVal strGuide As String)
    g_strGuide = strGuide
End Property
Public Property Get StsGuide() As String
    StsGuide = g_strGuide
End Property

'------------------------------------------<< End of Source >>--------------------------------------

